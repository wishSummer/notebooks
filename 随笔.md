2023.6.6
2、杭州移动平台，“实时状态查询”中，前端写死的3级，后端查询语句矫正到5级

1、react本体: https://react.docschina.org/docs/hello-world.html
2、redux: https://www.redux.org.cn/
3、react-saga: https://redux-saga-in-chinese.js.org/
5、dva: https://dvajs.com/guide/concepts.html
6、umijs(项目创建脚手架): https://umijs.org/zh-CN/docs/getting-started
7、antd(UI): https://mobile.ant.design/index-cn UI组件，PC版、移动版、app版都有
8、es6(重要): https://www.runoob.com/w3cnote/es6-tutorial.html’
{
    "hosts": [
        "unix:///var/run/docker.sock"
    ],
	 "registry-mirrors": ["https://0exvcft2.mirror.aliyuncs.com"],
	 "log-driver": "json-file",
	 "log-opts": {"max-size":"500m", "max-file":"3"}
}
接口部署，config分支添加配置文件的同时，服务器需要添加对应接口的service，修改一份启动服务的配置文件修改一下。

bootstrap
openfeign
consul-config
consul-discovery
getway

react
	redux
	effect

findAll(projectId)查询所有项目
findReginTree()查询所有地区列表
findAll(type)查询所有虚拟身份类型
query(form)按条件查询内容

ispresent()
isblank() 若为空，空字符也为空
isEmpty() 长度=0 


实时状态
出口iP	 宁波移动

导出excel 添加出口Ip


regionsId  后端对应需要修改

http://localhost:3005/local-api/isp/audit/session-find-by-page

http://localhost:3005/local-api/isp/ui/id-card-type

文件导入：
	web-service模块预处理阶段没有查询数据库做唯一值效验
	toolset模块向接口库导入数据没有对ai_iwifi_mac做唯一值效验，ai_iwifi_mac被设置为索引字段,被unique限定。


https://maint.hzwesoft.com/#/command   命令下发 搜索

# 注解@JsonFormat主要是后台到前台的时间格式的转换
@JsonFormat(shape = JsonFormat.Shape.STRING, pattern = "yyyy-MM-dd HH:mm:ss", timezone = "GMT+8")
注解@DateTimeFormat主要是前台到后台的时间格式的转换 "yyyy-MM-dd HH-mm-ss"


# uranus-app
 多模块使用一个模块的application启动
 1、重命名各模块beanname
 2、给各个模块controller添加web路径前缀
 3、项目根pom的dependencyManagement添加各个模块的依赖
 4、启动模块添加各个模块依赖

# @GrapeRepository
1、provider 服务端供消费的方法需要 public修饰，否则消费者请求不到方法
2、远程访问是通过mqtt实现，所以需要配置mqtt、grape、以及topic。


  guestId siteName siteId account  captureTime roomNo terminalMac guestMac
  code icon
  检索条件
  regionsId siteName code time account roomNo terminalMac guestMac  guestId

  利用ftp传输文件
  下载镜像，配置开放端口
  scp 复制


# 编写规范
	- bo 构建实体数据
	- vo 组合数据相应前端
    }
    
                    //            二维码设置
                    if (null != updateForm.getLogo()) {
                        authObject.setQrcodeLogo(updateForm.getLogo());
                    }
                    if (StringUtils.isNotBlank(updateForm.getQrcodeBackground())) {
                        authObject.setQrcodeBackground(
                            updateForm.getQrcodeBackground().toUpperCase().split("#")[1]);
                    }
                    if (StringUtils.isNotBlank(updateForm.getQrcodeForeground())) {
                        authObject.setQrcodeForeground(
                            updateForm.getQrcodeForeground().toUpperCase().split("#")[1]);
                    }
                    if (StringUtils.isNotBlank(updateForm.getQrcodeBottomFontColor())) {
                        authObject.getQrcodeBottomDescription()
                            .setColor(updateForm.getQrcodeBottomFontColor());
                    }
                    if (null != updateForm.getQrcodeBottomFontSize()) {
                        authObject.getQrcodeBottomDescription()
                            .setFontSize(updateForm.getQrcodeBottomFontSize());
                    }
                    if (StringUtils.isNotBlank(updateForm.getBottomWord())) {
                        authObject.getQrcodeBottomDescription().setContent(updateForm.getBottomWord());
                    }
                    if (StringUtils.isNotBlank(updateForm.getQrcodeTopFontColor())) {
                        authObject.getQrcodeTopDescription().setColor(updateForm.getQrcodeTopFontColor());
                    }
                    if (null != updateForm.getQrcodeTopFontSize()) {
                        authObject.getQrcodeTopDescription().setFontSize(updateForm.getQrcodeTopFontSize());
                    }
                    if (StringUtils.isNotBlank(updateForm.getTopWord())) {
                        authObject.getQrcodeTopDescription().setContent(updateForm.getTopWord());
                    }
    
                    // 催缴设置
                    if (StringUtils.isNotBlank(updateForm.getReminderStart())) {
                        customizedObject.setReminderStartAt(LocalDate.parse(updateForm.getReminderStart()));
                    }
                    if (StringUtils.isNotBlank(updateForm.getDefaultTip())) {
                        customizedObject.setReminderTooltip(updateForm.getDefaultTip());
                    }
                    if (StringUtils.isNotBlank(updateForm.getDeadline())) {
                        customizedObject.setReminderDeadline(LocalDate.parse(updateForm.getDeadline()));
                    }
    
                    return customizedJpaRepository.save(customizedObject);
                } else {
                    // 新增
                    CustomizedObject defaultcustomizedObject = customizedJpaRepository
                        .findCustomizedObjectByPreset(true).orElse(null);
    
                    CustomizedAuthObject authObject = defaultcustomizedObject.getAuthObject();
    
                    CustomizedObject newCustomized = new CustomizedObject();
                    CustomizedAuthObject newCustomizedAuth = new CustomizedAuthObject();
    
                    newCustomized.setRegionId(updateForm.getRegionId());
                    newCustomized.setPreset(false);
                    newCustomized.setCreateAt(LocalDateTime.now());
                    newCustomized.setCreateBy(updateForm.getUserName());
                    newCustomizedAuth.setLockScreenFontColor(authObject.getLockScreenFontColor());
                    newCustomizedAuth.setLockScreenUserIconColor(authObject.getLockScreenUserIconColor());
                    newCustomized.setRegionRank(Arrays.stream(RegionRank.values())
                        .filter(regionRank -> regionRank.code().equals(updateForm.getTabIndex())).findFirst()
                        .get());
                    //              认证
                    if (null == updateForm.getAuthCategory()) {
                        newCustomizedAuth.setAuthCategory(authObject.getAuthCategory());
                        newCustomizedAuth.setFastAuthType(authObject.getFastAuthType());
                        newCustomizedAuth.setFastAuthDefaultType(authObject.getFastAuthDefaultType());
                        newCustomizedAuth.setFaceCloudAuthValidDays(authObject.getFaceCloudAuthValidDays());
                        newCustomizedAuth.setFaceCloudAuthValidRank(authObject.getFaceCloudAuthValidRank());
                        newCustomizedAuth.setFaceRecognitionPayType(authObject.getFaceRecognitionPayType());
                        newCustomizedAuth.setFaceRecognitionCost(authObject.getFaceRecognitionCost());
                        newCustomizedAuth.setLockScreenClosed(authObject.getLockScreenClosed());
                        newCustomizedAuth.setLockScreenDisabled(authObject.getLockScreenDisabled());
                        newCustomizedAuth.setLockScreenIdleTimeout(authObject.getLockScreenIdleTimeout());
                        newCustomizedAuth
                            .setLockScreenUnlockMultiple(authObject.getLockScreenUnlockMultiple());
                        newCustomizedAuth.setUnderAgeAllowed(authObject.getUnderAgeAllowed());
                    } else {
                        newCustomizedAuth.setAuthCategory(Arrays.stream(AuthCategory.values())
                            .filter(authCategory -> authCategory.code().equals(updateForm.getAuthCategory()))
                            .findFirst().get());
                        //                if (newCustomizedAuth.getAuthCategory().equals(AuthCategory.Fast)) {
                        List<FastAuthType> fastAuthTypes = new ArrayList<>();
                        if (null != updateForm.getRoomNo()) {
                            fastAuthTypes.add(FastAuthType.RoomNo);
                        }
                        if (updateForm.getPhone() != null) {
                            fastAuthTypes.add(FastAuthType.Phone);
                        }
                        if (updateForm.getWechat() != null) {
                            fastAuthTypes.add(FastAuthType.Wechat);
                        }
    
                        if (!(fastAuthTypes.isEmpty() || fastAuthTypes.toArray().length <= 0)) {
                            newCustomizedAuth.setFastAuthType(fastAuthTypes);
                        } else {
                            newCustomizedAuth.setFastAuthType(authObject.getFastAuthType());
                        }
                        if (StringUtils.isNotBlank(updateForm.getAuthDefaultType())) {
                            newCustomizedAuth
                                .setFastAuthDefaultType(
                                    Arrays
                                        .stream(FastAuthType.values()).filter(fastAuthType -> fastAuthType
                                            .code().equals(updateForm.getAuthDefaultType()))
                                        .findFirst().get());
                        } else {
                            newCustomizedAuth.setFastAuthDefaultType(authObject.getFastAuthDefaultType());
                        }
                        //                }
                        //                if (newCustomizedAuth.getAuthCategory().equals(AuthCategory.Face)) {
                        newCustomizedAuth
                            .setFaceCloudAuthValidDays(Optional.ofNullable(updateForm.getCloudAuth())
                                .orElse(authObject.getFaceCloudAuthValidDays()));
    
                        //                    if (null != updateForm.getCloudAuth()) {
                        //                        newCustomizedAuth.setFaceCloudAuthValidDays(updateForm.getCloudAuth());
                        //                    }
                        if (null != updateForm.getCloudAuthRank()) {
                            newCustomizedAuth
                                .setFaceCloudAuthValidRank(Arrays.stream(FaceCloudAuthValidRank.values())
                                    .filter(faceCloudAuthValidRank -> faceCloudAuthValidRank.code()
                                        .equals(updateForm.getCloudAuthRank()))
                                    .findFirst().get());
                        } else {
                            newCustomizedAuth
                                .setFaceCloudAuthValidRank(authObject.getFaceCloudAuthValidRank());
                        }
                        if (null != updateForm.getFacePayType()) {
                            newCustomizedAuth
                                .setFaceRecognitionPayType(Arrays.stream(FaceRecognitionPayType.values())
                                    .filter(faceRecognitionPayType -> faceRecognitionPayType.code()
                                        .equals(updateForm.getFacePayType()))
                                    .findFirst().get());
                        } else {
                            newCustomizedAuth
                                .setFaceRecognitionPayType(authObject.getFaceRecognitionPayType());
                        }
                        if (null != updateForm.getRecognitionCost()) {
                            newCustomizedAuth
                                .setFaceRecognitionCost((int) (updateForm.getRecognitionCost() * 100));
                        } else {
                            newCustomizedAuth.setFaceRecognitionCost(authObject.getFaceRecognitionCost());
                        }
                        //                }
                    }
                    newCustomizedAuth
                        .setLockScreenIdleTimeout(Optional.ofNullable(updateForm.getLockScreenIdleTimeout())
                            .orElse(authObject.getLockScreenIdleTimeout()));
                    //            if (null != updateForm.getLockScreenIdleTimeout()) {
                    //                newCustomizedAuth.setLockScreenIdleTimeout(updateForm.getLockScreenIdleTimeout());
                    //            }
                    if (updateForm.getLockScreenDisabled() != null) {
                        newCustomizedAuth.setLockScreenDisabled(updateForm.getLockScreenDisabled());
                    }
                    if (updateForm.getLockScreenClosed() != null) {
                        newCustomizedAuth.setLockScreenClosed(updateForm.getLockScreenClosed());
                    }
                    if (updateForm.getUnderAgeAllowed() != null) {
                        newCustomizedAuth.setUnderAgeAllowed(updateForm.getUnderAgeAllowed());
                    }
                    if (updateForm.getLockScreenUnlockMultiple() != null) {
                        newCustomizedAuth
                            .setLockScreenUnlockMultiple(updateForm.getLockScreenUnlockMultiple());
                    }
    
                    //落地页
                    if (updateForm.getApplet() != null) {
                        newCustomized.setApplet(updateForm.getApplet());
                        if (updateForm.getApplet()) {
                            if (StringUtils.isNotBlank(updateForm.getAppPage())) {
                                newCustomized.setAppPage(updateForm.getAppPage());
                            }
                            if (StringUtils.isNotBlank(updateForm.getAppName())) {
                                newCustomized.setAppName(updateForm.getAppName());
                            }
                            if (StringUtils.isNotBlank(updateForm.getAppId())) {
                                newCustomized.setAppId(updateForm.getAppId());
                            }
                        }
                    } else {
                        newCustomized.setApplet(defaultcustomizedObject.getApplet());
                        newCustomized.setAppName(defaultcustomizedObject.getAppName());
                        newCustomized.setAppId(defaultcustomizedObject.getAppId());
                        newCustomized.setAppPage(defaultcustomizedObject.getAppPage());
                    }
    
                    //            二维码设置
                    newCustomizedAuth
                        .setQrcodeLogo(Optional.ofNullable(authObject.getQrcodeLogo()).orElse(null));
                    newCustomizedAuth.setQrcodeBackground(authObject.getQrcodeBackground());
                    newCustomizedAuth.setQrcodeForeground(authObject.getQrcodeForeground());
                    newCustomizedAuth.setQrcodeBottomDescription(authObject.getQrcodeBottomDescription());
                    newCustomizedAuth.setQrcodeTopDescription(authObject.getQrcodeTopDescription());
                    if (null != updateForm.getLogo()) {
                        newCustomizedAuth.setQrcodeLogo(updateForm.getLogo());
                    }
                    if (StringUtils.isNotBlank(updateForm.getQrcodeBackground())) {
                        newCustomizedAuth.setQrcodeBackground(
                            updateForm.getQrcodeBackground().toUpperCase().split("#")[1]);
                    }
                    if (StringUtils.isNotBlank(updateForm.getQrcodeForeground())) {
                        newCustomizedAuth.setQrcodeForeground(
                            updateForm.getQrcodeForeground().toUpperCase().split("#")[1]);
                    }
                    if (StringUtils.isNotBlank(updateForm.getQrcodeBottomFontColor())
                        && null != updateForm.getQrcodeBottomFontSize()
                        && StringUtils.isNotBlank(updateForm.getBottomWord())) {
                        CustomizedAuthObject.QrcodeDescription qrcodeDescription = new CustomizedAuthObject.QrcodeDescription();
                        qrcodeDescription.setContent(updateForm.getBottomWord());
                        qrcodeDescription.setColor(updateForm.getQrcodeBottomFontColor());
                        qrcodeDescription.setFontSize(updateForm.getQrcodeTopFontSize());
                        newCustomizedAuth.setQrcodeBottomDescription(qrcodeDescription);
                    }
                    if (StringUtils.isNotBlank(updateForm.getQrcodeTopFontColor())
                        && null != updateForm.getQrcodeTopFontSize()
                        && StringUtils.isNotBlank(updateForm.getTopWord())) {
                        CustomizedAuthObject.QrcodeDescription qrcodeDescription = new CustomizedAuthObject.QrcodeDescription();
                        qrcodeDescription.setContent(updateForm.getTopWord());
                        qrcodeDescription.setColor(updateForm.getQrcodeTopFontColor());
                        qrcodeDescription.setFontSize(updateForm.getQrcodeTopFontSize());
                        newCustomizedAuth.setQrcodeTopDescription(qrcodeDescription);
                    }
    
                    // 催缴设置
                    newCustomized.setReminderStartAt(defaultcustomizedObject.getReminderStartAt());
                    if (StringUtils.isNotBlank(updateForm.getReminderStart())) {
                        newCustomized.setReminderStartAt(LocalDate.parse(updateForm.getReminderStart()));
                    }
                    newCustomized.setReminderTooltip(Optional.ofNullable(updateForm.getDefaultTip())
                        .orElse(defaultcustomizedObject.getReminderTooltip()));
    
                    newCustomized.setReminderDeadline(defaultcustomizedObject.getReminderDeadline());
                    if (StringUtils.isNotBlank(updateForm.getDeadline())) {
                        newCustomized.setReminderDeadline(LocalDate.parse(updateForm.getDeadline()));
                    }
    
                    newCustomizedAuth.setCustomized(newCustomized);
                    newCustomized.setAuthObject(newCustomizedAuth);
    
                    return customizedJpaRepository.save(newCustomized);
                }
            }
        }
    }